<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
</head>
<body>
<script>
// Add 'var' keyword to declare variables properly
var vals = unescape(window.location.hash).substring(1).split("&", 4); // Remove the '#' character from the hash
var id = vals[0];
var more = (vals[1] !== "0"); // Use strict comparison
var nextChunk = vals[1];
var js_watcher_href = vals[2];
var json = vals[3];

if (more) {
  parent.DropioApiClient.AIM.parseResult(id, json, true);
  // Correct the split function and add proper URL encoding
  var xd_path = window.location.href.split("#")[0];
  window.location.href = js_watcher_href + "#" + encodeURIComponent(xd_path) + "&" + id + "&" + nextChunk;
} else {
  parent.DropioApiClient.AIM.parseResult(id, json, false);
}
</script>
</body>
</html>
